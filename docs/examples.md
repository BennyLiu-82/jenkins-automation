#Examples

## Checkmarx Security Job Builder

```
import jenkins.automation.builders.CheckmarxSecurityJobBuilder
def groupId = "your-group-id"  
def projectName ='foo'
new CheckmarxSecurityJobBuilder(
        name: "${projectName}-checkmarx",
        description: "Sample checkmarx security job",
        useOwnServerCredentials: false,
        serverUrl: "http://sample-serverUrl",
        username: "sample-username",
        password: "sample-password",
        groupId: "${groupId}",
        scanRepo: "https://github.com/OrlandoSoto/ckan-browser-tests",
        checkmarxComment: "Generated by Checkmarx job builder JAC",
        vulnerabilityThresholdEnabled: true,
        highThreshold: "1",
        mediumThreshold: "2",
        lowThreshold: "3",
        cleanWorkspace: true // Clean up the workspace before every checkout
).build(this);


```

## BDD Security Job Builder

```
import jenkins.automation.builders.BddSecurityJobBuilder
   
   def projectName ='foo'
   def bddSecurityRepo ="repo-to-scan'
   new BddSecurityJobBuilder(
           name: "${projectName}bdd_security_job",
           description: "Sample bdd security job",
           baseUrl: "http://google.com",
           bddSecurityRepo: "${bddSecurityRepo}",
           chromedriverPath: "\\/Users\\/sotoo\\/homebrew\\/bin\\/Chromedriver"
   ).build(this);
   

```

## Base Job Builder


```
import jenkins.automation.builders.BaseJobBuilder
   
   def baseJob = new BaseJobBuilder(
                   name: this.name,
                   description: this.description,
                   emails: this.emails 
   ).build(this)

```

## Flow Job Builder


```
import jenkins.automation.builders.FlowJobBuilder

    def flowJob= new FlowJobBuilder(
            name: 'GeneratedFlowJob',
            description: 'this our first stab at it',
            jobs:['job1', 'job2']
    ).build(this);
    
    flowJob.with{
      logRotator{
          numToKeep(365)
      }
    
    }
    def customFlowJob= new FlowJobBuilder(
            name: 'GeneratedCustomFlowJob',
            description: 'this a custom flow job',
            jobFlow: """
                build('job1')
                build('job2')
                parallel(
                 { build('job3') },
                 { build('job4') },
                )
            """
    ).build(this);

    customFlowJob.with{
      logRotator{
          numToKeep(365)
      }

    }

```

## JS Build Job


```

import jenkins.automation.builders.JsJobBuilder


String basePath = 'JsJobSamples'
List developers = ['irina.muchnik@cfpb.gov', 'daniel.davis@cfpb.gov']

def repos = [
        [name: 'jenkins-automation', url: "https://github.com/cfpb/jenkins-automation@2.0"],
        [name: 'collab', url: "https://github.com/cfpb/jenkins-automation", shallow: true]
        [name: 'other', url: "https://github.com/cfpb/jenkins-automation", disable_submodule: true]
]
folder(basePath) {
    description 'This example shows how to create jobs using Job builders.'
}


new JsJobBuilder(
        name: "$basePath/BuilderVsBuilders",
        description: 'An example using a job builder for a Javascript build jobs project.',
        repos: repos,
        emails: developers,
        use_versions: true
).build(this)

```
# Salesforce Build Job


```

import jenkins.automation.builders.SalesforceAntJobBuilder

List developers = ['irina.muchnik@cfpb.gov', 'daniel.davis@cfpb.gov']

def repo = "https://github.com/cfpb/saleforce-automation"

new SalesforceAntJobBuilder(
        name: "Deploy SF ",
        description: 'An example using a job builder for a Salesforce Ant JobBuilder build jobs project.',
        repoUrl: repo,
        emails: developers,
        antTaskName: "retrieveUnpackaged",
        antInstallerName:"ant-latest"
).build(this)

```

## Using MultiScm Utility

```

import javaposse.jobdsl.dsl.DslFactory
import javaposse.jobdsl.dsl.Job
import jenkins.automation.builders.BaseJobBuilder
import jenkins.automation.utils.ScmUtils

 def baseJob = new BaseJobBuilder(
                name: this.name,
                description: this.description,
                emails: this.emails
        ).build(factory)


 baseJob.with {
    multiscm {
        ScmUtils.project_repos(delegate, this.repos, use_versions)
        }
    }

  baseJob
 }

```

## Determining the environment

```
import jenkins.automation.utils.EnvironmentUtils


// ${ENVIRONMENT} is available directly from the scripts
// It is a jenkins environment variable that is set directly in 
//Jenkins system configuration.

def env = EnvironmentUtils.getInstance("${ENVIRONMENT}")

if (env.isDev()){
    //set any other environment specific variables here
}

job('test') {
    steps {
        shell """echo $env
      """
    }
}

```

## Common Utils

### Defaults
```
import jenkins.automation.utils.CommonUtils

job('example'){
    CommonUtils.addDefaults(delegate)
}
```

### Extended Email

```
import jenkins.automation.utils.CommonUtils

job("example"){
  CommonUtils.addExtendedEmail(delegate, 
  emails = 'someperson@email.com, someotherperson@email.com') 
         
}
   
   
//override accepts emails as a list. Compatible with builders
job('example'){
  CommonUtils.addExtendedEmail(delegate, 
  emails = ['someperson@email.com', 'someotherperson@email.com']) 
}
```
